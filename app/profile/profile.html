<h1>Profile</h1>
<p>
    You can share your progress with coaches, and teams. You can also enable a public
    profile page.
</p>
<div class="box loading" ng-if="!profileSettings.username && !profileSettings.$resolved">
  <span>
    <i class="fa fa-spinner fa-spin fa-4x fa-fw"></i><br/>
    Loading
</span>
</div>
<div ng-if="!profileSettings.username && profileSettings.$resolved">
  <p>You do not have an username set, to access these functionalities you must have a username set</p>
  <div class="center">
      <form ng-submit="setUsername(newUsername)">
          <input type="text" placeholder="Username" ng-model="newUsername" />
          <input type="submit" value="Set Username" />
      </form>
      <div ng-if="error" class="error">{{ error }}</div>
      <div class="box loading" ng-if="checking">
        <span>
          <i class="fa fa-spinner fa-spin fa-4x fa-fw"></i><br/>
          Checking Username avilability
      </span>
      </div>
  </div>
</div>
<div class="center" ng-if="profileSettings.username">
    <h2>Profile Page</h2>
    <p>
        You can always see your complete profile on
        <a ng-href="/profile/{{ profileSettings.username | lowercase }}">the-tricktionary.com/profile/{{ profileSettings.username | lowercase }}</a>        by enabling a public profile you will make that profile public to everyone.
        You can choose wether to show a list of tricks you've completed, your speed
        highscores or neither. If you choose neither your public profile page will
        just show the ammount of tricks you've completed. If you have your profile
        set to public you can share the above link.
    </p>
    <a ng-click="profileSettings.public = !profileSettings.public; profileSettings.$save()"
        class="black"><i ng-class="(profileSettings.public ? 'checked' : '')" class="checkbox"></i>        Enable public profile</a>
        <div ng-show="profileSettings.public">
            <a ng-click="profileSettings.checklist = !profileSettings.checklist; profileSettings.$save();"
                class="black"><i ng-class="(profileSettings.checklist ? 'checked' : '')" class="checkbox"></i>                Display completed tricks on your public profile page</a>
                </br>
                <a ng-click="profileSettings.speed = !profileSettings.speed; profileSettings.$save();"
                    class="black"><i ng-class="(profileSettings.speed ? 'checked' : '')" class="checkbox"></i>                    Show your speed highscores on your public profile page</a>
                    </br>
        </div>
</div>
<div ng-if="profileSettings.username">
    <h2>Friends</h2>
    <h3>Send a friend request</h3>
    <div class="center">
        <form ng-submit="addFriend(frUname)">
            <input type="text" placeholder="friend's username" ng-model="frUname" />
            <input type="submit" value="Send friend request" />
        </form>
    </div>
    <h3 ng-if="friendrequests.length > 0">Friend Requests</h3>
    <div ng-repeat="request in friendrequests" class="center article">
      <span>{{ request.username || request.$id }}</span>
      <div class="mt">
        <button ng-click="addFriend(request.username, request.$id)" class="green inline"><i class="fa fa-user-plus"></i> Accept Friend Request</button>
        <button ng-click="friendrequests.$remove(request)" class="red inline"><i class="fa fa-user-times"></i> Ignore Friend Request</button>
      </div>
    </div>
    <h3 ng-if="friends.length > 0">Friends</h3>
    <div ng-repeat="friend in friends" class="center article">
      <a ng-if="friend.mutual && friend.username" href="/profile/{{ friend.username }}">{{ friend.username || friend.$id }}</a>
      <span ng-if="!friend.mutual || !friend.username">{{ friend.username || friend.$id }}</span>
      <div class="mt">
        <button ng-confirm-click="Do you really want to remove {{ friend.username || friend.$id }} as a friend?" confirmed-click="friends.$remove(friend)" class="red inline"><i class="fa fa-user-times"></i> {{ (friend.mutual ? 'Remove Friend' : 'Cancel Request') }}</button>
      </div>
    </div>
</div>
<div ng-if="profileSettings.username">
    <h2>Coaches</h2>
    <h3>Add a coach</h3>
    <div class="center">
        <form ng-submit="addCoach(coUname)">
            <input type="text" placeholder="coach's username" ng-model="coUname" />
            <input type="submit" value="add as coach" />
        </form>
    </div>
    <h3 ng-if="coaches.length > 0">Your coaches</h3>
    <div ng-repeat="coach in coaches" class="center article">
      <span>{{ coach.$id }}</span>
      <div class="mt">
        <button ng-confirm-click="Do you really want to remove {{ coach.$id }} as coach?" confirmed-click="removeCoach(coach.$id)" class="red inline"><i class="fa fa-user-times"></i> Remove Coach</button>
      </div>
    </div>
</div>
